{% extends "base.html" %}
{% block content %}
<h2>印刷ルール</h2>

<div class="grid">
  <div class="card">
    <h3>新規ルール</h3>
    <form method="post" action="{{ url_for('admin_rules_new') }}">
      <label>カテゴリ（任意）</label>
      <select name="カテゴリID">
        <option value="">(なし)</option>
        {% for c in cats %}<option value="{{ c['id'] }}">{{ c['名称'] }}</option>{% endfor %}
      </select>

      <label>メニュー（任意）</label>
      <select name="メニューID">
        <option value="">(なし)</option>
        {% for m in menu %}<option value="{{ m['id'] }}">{{ m['名称'] }}</option>{% endfor %}
      </select>

      <label>プリンタ</label>
      <select name="プリンタID" required>
        {% for p in printers %}<option value="{{ p['id'] }}">{{ p['名称'] }}</option>{% endfor %}
      </select>

      <button class="btn" type="submit">追加</button>
    </form>
  </div>

  <div class="card">
    <h3>一覧</h3>
    <table>
      <thead><tr><th>#</th><th>カテゴリ</th><th>メニュー</th><th>プリンタ</th><th>操作</th></tr></thead>
      <tbody>
        {% for r in rules %}
        <tr>
          <td>{{ r['id'] }}</td>
          <td>{{ r['cat_name'] or '-' }}</td>
          <td>{{ r['menu_name'] or '-' }}</td>
          <td>{{ r['printer_name'] }}</td>
          <td>
            <form method="post" action="{{ url_for('admin_rules_delete', rid=r['id']) }}" style="display:inline" onsubmit="return confirm('削除しますか？')">
              <button class="btn sub" type="submit">削除</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
